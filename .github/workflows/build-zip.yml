name: Build html2app Package

on:
  push:
    branches:
      - main
  workflow_dispatch:   # ‡¶ö‡¶æ‡¶á‡¶≤‡ßá ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßÅ‡ßü‡¶æ‡¶≤‡¶ø ‡¶∞‡¶æ‡¶® ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      # ‚úÖ ‡¶ï‡ßã‡¶° ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°
      - name: Checkout repository
        uses: actions/checkout@v3

      # ‚úÖ Node.js ‡¶∏‡ßá‡¶ü‡¶Ü‡¶™ (npm run build ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶¶‡¶∞‡¶ï‡¶æ‡¶∞)
      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: 18

      # ‚úÖ Dependencies ‡¶á‡¶®‡ßç‡¶∏‡¶ü‡¶≤
      - name: Install dependencies
        run: npm install

      # ‚úÖ ‡¶ì‡ßü‡ßá‡¶¨ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶∏‡ßá‡¶ü ‡¶¨‡¶ø‡¶≤‡ßç‡¶° (www/ ‡¶´‡ßã‡¶≤‡ßç‡¶°‡¶æ‡¶∞ ‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡¶¨‡ßá)
      - name: Build web assets
        run: npm run build

      # ‚úÖ app.zip ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶æ
      - name: Create app.zip
        run: zip -r app.zip www assets config.json

      # ‚úÖ app.zip ‡¶Ü‡¶™‡¶≤‡ßã‡¶° (Artifacts ‡¶è ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá)
      - name: Upload app.zip
        uses: actions/upload-artifact@v3
        with:
          name: app.zip
          path: app.zip

      # ‚úÖ ‡¶∂‡ßá‡¶∑‡ßá html2app.dev ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã (‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡ßá ‡¶ñ‡ßÅ‡¶≤‡¶§‡ßá ‡¶π‡¶¨‡ßá)
      - name: Show Upload Link
        run: echo "üëâ Upload this app.zip to https://html2app.dev/ to generate APK"